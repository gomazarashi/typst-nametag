# Typstで紙の名札(PDF)を量産する

## はじめに

この記事ではTypstを用いて、あらかじめ参加者の名前や所属、役割等がわかっている前提で、イベント用の名札をPDF形式で大量に作成する方法について説明します。Typst自体の解説については割愛しますので、既存の日本語記事や[公式ドキュメント](https://typst.app/docs/)、[非公式日本語版ドキュメント](https://typst-jp.github.io/docs/)等を参照してください。

使用する手法としては、Typstが公式にサポートしている[外部データの読み込み](https://typst.app/docs/reference/data-loading/)機能等を利用して、**CSV**ファイルから参加者情報を読み込む、というのがメインになります。今回はCSVファイルを扱いますが、前述のデータ読み込み機能は**YAML**や**JSON**、**XML**などもサポートしているため、必要があればそれらのファイルを利用しても問題ないと思います。

今回想定している「名札」というのは、勉強会やカンファレンス、LT会などで使用される、縦型のA6サイズ(105mm x 148mm)の紙の名札を指します。ただ、この用紙サイズに関しても自由に変更していただいて問題なさそうです(名刺サイズであったり)。Typstの機能を使えばいろいろと凝ったものは作れそうですが、ここでは簡単のために以下のような要素を含んだ名札を作成します。



- 参加者の氏名（フルネーム）
- 所属・会社名・組織名
  - 氏名の下に中くらいの文字サイズで表示する
- 役割・カテゴリ
  - `Attendee` / `Speaker` / `Staff` など
  - 色付きのラベル等で区別できるようにする
- イベント名・ロゴ
  - 下部に小さめに配置する

作り方としては、以下の2パターンを紹介します。
- パターンA: **1つのPDFファイル**に全員分の名札をまとめて出力する
- パターンB: 参加者ごとに**PDFファイルを分割**して出力する

おそらく主に使われるのはパターンAだと思いますが、ファイルごとに管理したい場合もあるかもしれません。ただし、後述しますがパターンBではTypstの標準機能ではなくPythonなどでCSVファイルを読み込み、データを流し込む必要があるので少し手間がかかります。

## 環境

今回この記事を書くにあたって利用した環境を示しておきます。正直これ以外の環境でも問題なく動作すると思います。

- OS: Windows 11
- Typst: 0.14.0

## ディレクトリ構成

今回の記事では最終的に以下のようなディレクトリ/ファイル構成にすることを想定しています。

```text
badges
├── badge_template.typ    # 共通テンプレート（パターンA・B共通）
├── all_badges.typ        # パターンA用Typstファイル
├── single_badge.typ      # パターンB用Typstファイル
├── participants.csv      # 参加者情報（パターンA・B共通）
├── generate_badges.py    # パターンB用Pythonスクリプト
├── assets                # 画像等のアセット
│   └── logo.png          # イベントロゴ画像
└── output                # 出力先
    ├── all_badges.pdf    # パターンAの出力先
    └── single_badges     # パターンBの出力先
```

各ディレクトリ/ファイルの役割は以下の通りです。

- badge_template.typ
名札1枚分（A6縦）のレイアウトとロジックを定義するTypstファイルです。氏名・所属・役割ラベル・イベント名・ロゴの配置やスタイルをまとめておき、パターンA/Bのどちらからも共通で読み込みます。

- all_badges.typ
participants.csvから全参加者分のデータをcsv()で読み込み、1人につき1ページの名札を生成して、複数ページからなる1つのPDF(output/all_badges.pdf)を出力するエントリポイントです（パターンA）。

- single_badge.typ
1人分の参加者情報だけを入力として受け取り、その人の名札1枚だけをPDFとして出力するエントリポイントです（パターンB）。Typstのsys.inputs機能などを使ってCLIから値を受け取り、その値をbadge_template.typ内のレイアウト関数に渡します。

- participants.csv
参加者一覧を保持するCSVファイルです。

- generate_badges.py
パターンB用のPythonスクリプトです。participants.csvを読み込み、各行の参加者情報をsingle_badge.typに渡してTypstを実行し、output/single_badges/配下に参加者ごとのPDFファイルを生成します。

- assets/logo.png
名札に表示するイベントロゴ画像です。badge_template.typからimage("assets/logo.png",...)のように読み込みます。

- output/
生成されたPDFファイルの出力先ディレクトリです。パターンAの出力であるall_badges.pdfと、パターンBで生成するsingle_badges/配下のPDFをまとめます。

## 共通テンプレートの作成
まずは名札1枚分のレイアウトとロジックを定義する共通テンプレート`badge_template.typ`を作成していきます。

コードの記述にはVSCodeを、プレビューにはVSCodeの拡張機能として提供されている[Tinymist](https://github.com/Myriad-Dreamin/tinymist)を利用しています。







